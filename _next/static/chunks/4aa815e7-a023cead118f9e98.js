"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[800],{18167:function(e,t,n){n.d(t,{PB:function(){return eK},RW:function(){return v},cV:function(){return eE}});var a=n(2611),i=n(77378),r=n(85877),s=n(93727),u=n(795),p=n(75423),o=n(88901),y=n(84772),l=n(36735),m=n(69130),d=n(66634),c=n(3431),b=n(2790),f={MAYAN_FORWARDER_CONTRACT:"0x337685fdaB40D39bd02028545a4FfA7D287cC3E2",MAYAN_PROGRAM_ID:"FC4eXxkyrMPTjiYUpp4EAnkmwMbQyZ6NDCh1kfLn6vsf",AUCTION_PROGRAM_ID:"8QJmxZcEzwuYmCPy6XqgN2sHcYCcFq6AEfBMJZZuLo5a",MCTP_PROGRAM_ID:"dkpZqrxHFrhziEMQ931GLtfy11nFkCsfMftH9u6QwBU",SWIFT_PROGRAM_ID:"BLZRi6frs4X4DNLw56V4EXai1b6QVESN1BhHBTYM9VcY",FEE_MANAGER_PROGRAM_ID:"5VtQHnhs2pfVEr68qQsbTRwKh4JV5GTu9mBHgHFxpHeQ",WORMHOLE_PROGRAM_ID:"worm2ZoG2kUd4vFXhvjh93UUH596ayRfgQ2MgjNMTth",CCTP_CORE_PROGRAM_ID:"CCTPmbSD7gX1bxKPAmg77w8oFzNFpaQiQUWD43TKaecd",CCTP_TOKEN_PROGRAM_ID:"CCTPiPYPc6AsJuwueEnWgSgucamXDZwBd53dQ11YiKX3",TOKEN_PROGRAM_ID:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",TOKEN_2022_PROGRAM_ID:"TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb",ASSOCIATED_TOKEN_PROGRAM_ID:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",LOOKUP_TABLE:"75X8YgJPcadksw6Ag3qsYUfi1bsFwDoCKYtqPPqdydAG",EXPLORER_URL:"https://explorer-api.mayan.finance/v3",PRICE_URL:"https://price-api.mayan.finance/v3",RELAYER_URL:"https://relayer-api.mayan.finance/v3"},T=p.sha3_256,g=e=>/^(0x)?[0-9a-fA-F]+::\w+::\w+$/.test(e);function h(e,t){if(1===t)return(0,i.U3)(new s.PublicKey(e).toBytes(),32);if(t===M.ethereum||t===M.bsc||t===M.polygon||t===M.avalanche||t===M.arbitrum||t===M.optimism||t===M.base||t===M.unichain||t===M.linea)return(0,i.U3)(e,32);if(t===M.aptos&&g(e))return`0x${T(e)}`;if(t===M.sui){let t=e.startsWith("0x")?e.substring(2):e;if(32!==u.Buffer.from(t,"hex").length)throw Error("Invalid sui address: "+e);return(0,i.U3)(e,32)}throw console.log(`Unsupported chain id: ${t}`,e),Error("Unsupported token chain")}function I(e){return new Uint8Array(u.Buffer.from(e.startsWith("0x")?e.substring(2):e,"hex"))}function w(e,t,n=!1,a=new s.PublicKey(f.TOKEN_PROGRAM_ID),i=new s.PublicKey(f.ASSOCIATED_TOKEN_PROGRAM_ID)){if(!n&&!s.PublicKey.isOnCurve(t.toBuffer()))throw Error("TokenOwnerOffCurveError");let[r]=s.PublicKey.findProgramAddressSync([t.toBuffer(),a.toBuffer(),e.toBuffer()],i);return r}function A(e,t){if(null==e)throw Error("getAmountOfFractionalAmount: Amount is null or undefined");if("string"!=typeof e&&"number"!=typeof e)throw Error("getAmountOfFractionalAmount: Amount is not a string or number");if("string"==typeof e&&0===e.length)throw Error("getAmountOfFractionalAmount: Amount is empty");if(!Number.isFinite(Number(e)))throw Error("getAmountOfFractionalAmount: Amount is not a number");let n=Math.min(8,Number(t)),a=Number(e).toFixed(n+1),i=RegExp(`^-?\\d+(?:\\.\\d{0,${n}})?`),s=a.match(i);if(!s)throw Error("getAmountOfFractionalAmount: fixedAmount is null");let u=s[0];return(0,r.vz)(u,Number(t))}var M={solana:1,ethereum:2,bsc:4,polygon:5,avalanche:6,arbitrum:23,optimism:24,base:30,aptos:22,sui:21,unichain:44,linea:38},k={1:2,56:4,137:5,43114:6,42161:23,10:24,8453:30,130:44,59144:38},C=[10,6,0];function P(){return C.join("_")}function S(e){return"solana"===e?9:18}var R=BigInt(2)**BigInt(64)-BigInt(1);function _(e){if(e<BigInt(0)||e>R)throw Error(`Invalid u64: ${e}`);let t=u.Buffer.alloc(8);return t.writeBigUInt64LE(e),t}var E={value:BigInt(0),deadline:0,v:0,r:`0x${s.SystemProgram.programId.toBuffer().toString("hex")}`,s:`0x${s.SystemProgram.programId.toBuffer().toString("hex")}`};function O(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}function F(e,t){return e&&t?"WH"===e.type?t?.solana||null:"MCTP"===e.type||"SWIFT"===e.type?"solana"===e.toChain?t?.solana||null:"sui"===e.toChain?t?.sui||null:t?.evm||null:"FAST_MCTP"===e.type&&"solana"!==e.toChain&&"sui"!==e.toChain&&t?.evm||null:null}function D(e){return Object.entries(e).filter(([e,t])=>null!=t&&!Array.isArray(t)).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&")}async function B(e){if(e.status.toString().startsWith("5")){let t;try{let n=await e.json();(n?.code||n?.statusCode)&&(n?.message||n?.msg)&&(t={code:n?.code||n?.statusCode,message:n?.message||n?.msg})}catch(e){t=Error("Internal server error")}throw t}}async function v(e,t={swift:!0,mctp:!0,gasless:!1,onlyDirect:!1}){var n;let i=function(e,t={wormhole:!0,swift:!0,mctp:!0,shuttle:!0,gasless:!1,onlyDirect:!1,fastMctp:!0}){let{gasDrop:n,referrerBps:a}=e,i=e.slippageBps;"auto"===i||Number.isFinite(i)||(i=100*e.slippage);let r={wormhole:!1!==t.wormhole,swift:!1!==t.swift,mctp:!1!==t.mctp,shuttle:!0===t.shuttle,fastMctp:!1!==t.fastMctp,gasless:!0===t.gasless,onlyDirect:!0===t.onlyDirect,solanaProgram:f.MAYAN_PROGRAM_ID,forwarderAddress:f.MAYAN_FORWARDER_CONTRACT,amountIn:!e.amountIn64&&Number.isFinite(e.amount)?e.amount:void 0,amountIn64:e.amountIn64,fromToken:e.fromToken,fromChain:e.fromChain,toToken:e.toToken,toChain:e.toChain,slippageBps:i,referrer:e.referrer,referrerBps:Number.isFinite(a)?a:void 0,gasDrop:Number.isFinite(n)?n:void 0,sdkVersion:P()};return`${f.PRICE_URL}/quote?`+D(r)}(e,t),r=await a(i,{method:"GET",redirect:"follow"});await B(r);let s=await r.json();if(200!==r.status&&201!==r.status)throw{code:s?.code||0,message:s?.msg||s?.message||"Route not found",data:s?.data};if(n=s.minimumSdkVersion,C[0]<n[0]||!(C[0]>n[0])&&(C[1]<n[1]||!(C[1]>n[1])&&!(C[2]>=n[2])))throw{code:9999,message:"Swap SDK is outdated!"};return s.quotes}async function K(){let e=await a(`${f.RELAYER_URL}/active-relayers?solanaProgram=${f.MAYAN_PROGRAM_ID}`,{method:"GET",redirect:"follow"});await B(e);let t=await e.json();if(200!==e.status&&201!==e.status)throw t;return t.suggested}async function N(e){let t=D({...e,sdkVersion:P()}),n=await a(`${f.PRICE_URL}/get-swap/solana?${t}`,{method:"GET",redirect:"follow"});await B(n);let i=await n.json();if(200!==n.status&&201!==n.status)throw i;return i}async function W(e){let t=await a(`${f.EXPLORER_URL}/submit/solana`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({signedTx:e})});await B(t);let n=await t.json();if(200!==t.status&&201!==t.status)throw n;return n}var x=[{inputs:[{internalType:"address",name:"_tokenBridge",type:"address"},{internalType:"address",name:"_weth",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint16",name:"emitterChainId",type:"uint16"},{indexed:!0,internalType:"bytes32",name:"emitterAddress",type:"bytes32"},{indexed:!0,internalType:"uint64",name:"sequence",type:"uint64"}],name:"Redeemed",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"tokenAddr",type:"bytes32"},{internalType:"uint16",name:"tokenChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"sourceAddr",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint64",name:"sequence",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bool",name:"unwrapRedeem",type:"bool"},{internalType:"bool",name:"unwrapRefund",type:"bool"}],internalType:"struct MayanStructs.Swap",name:"s",type:"tuple"}],name:"encodeSwap",outputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],stateMutability:"pure",type:"function"},{inputs:[],name:"getWeth",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRedeemPayload",outputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"uint64",name:"relayerFee",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanStructs.Redeem",name:"r",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeem",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeemAndUnwrap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"}],name:"swap",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"sweepEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"sweepToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"}],name:"wrapAndSwapETH",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{stateMutability:"payable",type:"receive"}],U=[{inputs:[{internalType:"address",name:"_guardian",type:"address"},{internalType:"address[]",name:"_swapProtocols",type:"address[]"},{internalType:"address[]",name:"_mayanProtocols",type:"address[]"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"UnsupportedProtocol",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedEth",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"SwapAndForwarded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"tokenIn",type:"address"},{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedEth",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"mayanProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setMayanProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setSwapProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"swapProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],G=[{inputs:[{internalType:"address",name:"_cctpTokenMessenger",type:"address"},{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"CallerAlreadySet",type:"error"},{inputs:[],name:"CallerNotSet",type:"error"},{inputs:[],name:"CctpReceiveFailed",type:"error"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DomainAlreadySet",type:"error"},{inputs:[],name:"DomainNotSet",type:"error"},{inputs:[],name:"EmitterAlreadySet",type:"error"},{inputs:[],name:"EthTransferFailed",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAddress",type:"error"},{inputs:[],name:"InvalidAmountOut",type:"error"},{inputs:[],name:"InvalidCaller",type:"error"},{inputs:[],name:"InvalidDestAddr",type:"error"},{inputs:[],name:"InvalidDomain",type:"error"},{inputs:[],name:"InvalidEmitter",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidMintRecipient",type:"error"},{inputs:[],name:"InvalidNonce",type:"error"},{inputs:[],name:"InvalidOrder",type:"error"},{inputs:[],name:"InvalidPayload",type:"error"},{inputs:[],name:"InvalidProtocolFee",type:"error"},{inputs:[],name:"InvalidRedeemFee",type:"error"},{inputs:[],name:"InvalidReferrerFee",type:"error"},{inputs:[],name:"MintRecipientAlreadySet",type:"error"},{inputs:[],name:"MintRecipientNotSet",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint32",name:"sourceDomain",type:"uint32"},{indexed:!1,internalType:"uint64",name:"sourceNonce",type:"uint64"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint32",name:"sourceDomain",type:"uint32"},{indexed:!1,internalType:"uint64",name:"sourceNonce",type:"uint64"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"OrderRefunded",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"bytes",name:"customPayload",type:"bytes"}],name:"bridgeWithFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint256",name:"redeemFee",type:"uint256"},{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"}],name:"bridgeWithLockedFee",outputs:[{internalType:"uint64",name:"cctpNonce",type:"uint64"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"cctpTokenMessenger",outputs:[{internalType:"contract ITokenMessenger",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint16",name:"",type:"uint16"}],name:"chainIdToEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"params",type:"tuple"}],name:"createOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"",type:"uint32"}],name:"domainToCaller",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint64",name:"",type:"uint64"}],name:"feeStorage",outputs:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"redeemFee",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"driver",type:"bytes32"}],internalType:"struct MayanCircle.FulfillParams",name:"params",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"}],name:"fulfillOrder",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"}],name:"getDomain",outputs:[{internalType:"uint32",name:"domain",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"keyToMintRecipient",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"localDomain",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"burnAmount",type:"uint64"},{internalType:"bytes32",name:"burnToken",type:"bytes32"},{internalType:"bytes32",name:"customPayload",type:"bytes32"}],internalType:"struct MayanCircle.BridgeWithFeeParams",name:"bridgeParams",type:"tuple"}],name:"redeemWithFee",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"redeemWithLockedFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"cctpNonce",type:"uint32"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"refineFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"orderParams",type:"tuple"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"}],internalType:"struct MayanCircle.ExtraParams",name:"extraParams",type:"tuple"}],name:"refund",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"},{internalType:"uint32",name:"domain",type:"uint32"}],name:"setDomain",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint32",name:"domain",type:"uint32"},{internalType:"bytes32",name:"caller",type:"bytes32"}],name:"setDomainCaller",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"},{internalType:"bytes32",name:"emitter",type:"bytes32"}],name:"setEmitter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"bytes32",name:"mintRecipient",type:"bytes32"}],name:"setMintRecipient",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"}],internalType:"struct MayanCircle.UnlockFeeMsg",name:"unlockMsg",type:"tuple"}],name:"unlockFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm1",type:"bytes"},{internalType:"bytes",name:"encodedVm2",type:"bytes"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"}],internalType:"struct MayanCircle.UnlockFeeMsg",name:"unlockMsg",type:"tuple"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"}],internalType:"struct MayanCircle.UnlockRefinedFeeMsg",name:"refinedMsg",type:"tuple"}],name:"unlockFeeRefined",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}];function L(e){switch(e){case"ethereum":return 0;case"avalanche":return 1;case"optimism":return 2;case"arbitrum":return 3;case"solana":return 5;case"base":return 6;case"polygon":return 7;case"sui":return 8;case"unichain":return 10;case"linea":return 11;default:throw Error("unsupported chain for cctp")}}function q(e,t){let n=new s.PublicKey(f.CCTP_CORE_PROGRAM_ID),a=new s.PublicKey(f.CCTP_TOKEN_PROGRAM_ID),[i]=s.PublicKey.findProgramAddressSync([u.Buffer.from("message_transmitter")],n),[r]=s.PublicKey.findProgramAddressSync([u.Buffer.from("sender_authority")],a),[p]=s.PublicKey.findProgramAddressSync([u.Buffer.from("local_token"),e.toBytes()],a),[o]=s.PublicKey.findProgramAddressSync([u.Buffer.from("token_messenger")],a),[y]=s.PublicKey.findProgramAddressSync([u.Buffer.from("token_minter")],a),l=L(t),[m]=s.PublicKey.findProgramAddressSync([u.Buffer.from("remote_token_messenger"),u.Buffer.from(l.toString())],a),[d]=s.PublicKey.findProgramAddressSync([u.Buffer.from("__event_authority")],n),[c]=s.PublicKey.findProgramAddressSync([u.Buffer.from("__event_authority")],a);return{messageTransmitter:i,senderAuthority:r,remoteTokenMessengerKey:m,tokenMessenger:o,tokenMinter:y,eventAuthToken:c,eventAuthCore:d,localToken:p}}function H(e,t,n,a){let i=function(e,t,n,a){let i=k[Number(n)],r=M[e.fromChain],s=M[e.toChain];if(r!==i)throw Error(`Signer chain id(${Number(n)}) and quote from chain are not same! ${r} !== ${i}`);let p=e.cheaperChain===e.fromChain;if(p&&a)throw Error("Bridge lock fee cannot have custom payload");let o=h(t,s),y=A(e.redeemRelayerFee,6),l=A(e.gasDrop,Math.min(S(e.toChain),8)),m=BigInt(e.effectiveAmountIn64),d=L(e.toChain);if(!e.mctpMayanContract)throw Error("MCTP contract address is missing");let c=e.mctpMayanContract;if("solana"===e.toChain&&p)throw Error("Cannot lock fee for transfer to solana");let b=A(e.bridgeFee,S(e.fromChain));return p&&(b=BigInt(0)),{lockFee:p,tokenIn:e.mctpInputContract,amountIn:m,redeemFee:y,gasDrop:l,destAddr:o,destDomain:d,payloadType:a?2:1,customPayload:a?`0x${u.Buffer.from(a).toString("hex")}`:"0x",bridgeFee:b,contractAddress:c}}(e,t,n,a),{contractAddress:r,tokenIn:s,amountIn:p,destAddr:o,lockFee:m,redeemFee:d,gasDrop:c,destDomain:b,customPayload:f,payloadType:T,bridgeFee:g}=i,I=new y.CH(r,G);return{to:r,data:m?I.interface.encodeFunctionData("bridgeWithLockedFee",[s,p,c,d,b,o]):I.interface.encodeFunctionData("bridgeWithFee",[s,p,d,c,o,b,T,f]),value:(0,l.m9)(g),_params:i}}function V(e,t,n,a){let i=function(e,t,n,a){let i;let r=k[Number(a)],u=M[e.fromChain],p=M[e.toChain];if(u!==r)throw Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${u} !== ${r}`);if(!e.mctpMayanContract)throw Error("MCTP contract address is missing");let y=e.mctpMayanContract,l=h(t,p);i=n?h(n,p):h(s.SystemProgram.programId.toString(),M.solana);let m=A(e.redeemRelayerFee,6),d=A(e.gasDrop,Math.min(S(e.toChain),8)),c=BigInt(e.effectiveAmountIn64),b=A(e.minAmountOut,Math.min(8,e.toToken.decimals)),f=BigInt(e.deadline64),T=e.toToken.contract===o.N?h(s.SystemProgram.programId.toString(),M.solana):h("sui"===e.toChain?e.toToken.verifiedAddress:e.toToken.contract,e.toToken.wChainId);return{params:{tokenIn:e.mctpInputContract,amountIn:c,gasDrop:d,destAddr:l,destChain:p,tokenOut:T,minAmountOut:b,deadline:f,redeemFee:m,referrerAddr:i,referrerBps:e.referrerBps||0},bridgeFee:A(e.bridgeFee,S(e.fromChain)),contractAddress:y}}(e,t,n,a),{contractAddress:r,params:u,bridgeFee:p}=i,m=new y.CH(r,G).interface.encodeFunctionData("createOrder",[u]);return{to:r,data:m,value:(0,l.m9)(p),_params:i}}var Y=[{inputs:[{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"_solanaEmitter",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DuplicateOrder",type:"error"},{inputs:[],name:"FeesTooHigh",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAmount",type:"error"},{inputs:[],name:"InvalidAuctionMode",type:"error"},{inputs:[],name:"InvalidBpsFee",type:"error"},{inputs:[],name:"InvalidContractSignature",type:"error"},{inputs:[],name:"InvalidDestChain",type:"error"},{inputs:[],name:"InvalidEmitterAddress",type:"error"},{inputs:[],name:"InvalidEmitterChain",type:"error"},{inputs:[],name:"InvalidEvmAddr",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidOrderHash",type:"error"},{inputs:[],name:"InvalidOrderStatus",type:"error"},{inputs:[],name:"InvalidSignature",type:"error"},{inputs:[],name:"InvalidSignatureLength",type:"error"},{inputs:[],name:"InvalidSigner",type:"error"},{inputs:[],name:"InvalidSrcChain",type:"error"},{inputs:[],name:"InvalidWormholeFee",type:"error"},{inputs:[],name:"OrderNotExists",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"SmallAmountIn",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"}],name:"OrderCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderRefunded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderUnlocked",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"canceler",type:"bytes32"}],name:"cancelOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithEth",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes",name:"signedOrderHash",type:"bytes"}],name:"createOrderWithSig",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithToken",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillSimple",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"orders",outputs:[{internalType:"enum MayanSwift.Status",name:"status",type:"uint8"},{internalType:"uint64",name:"amountIn",type:"uint64"},{internalType:"uint16",name:"destChainId",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseFulfillPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"driver",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"}],internalType:"struct MayanSwift.FulfillMsg",name:"fulfillMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRefundPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"bytes32",name:"canceler",type:"bytes32"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwift.RefundMsg",name:"refundMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseUnlockPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],internalType:"struct MayanSwift.UnlockMsg",name:"unlockMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32[]",name:"orderHashes",type:"bytes32[]"}],name:"postBatch",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"refundOrder",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"solanaEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"unlockMsgs",outputs:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockSingle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],$={};function j(e){return $[e]??=new s.Connection(e),new s.Connection(e)}async function Q({trx:e,connection:t,errorChance:n,extraRpcs:a,options:i,rate:r=8}){let s=null,u=0,p=[t].concat(a.map(j));for(let t=0;t<r;t++){if(s)try{let t=await Promise.any(p.map(e=>e.getSignatureStatus(s)));if(t&&t.value){if(t.value.err){if(u>=n)return{signature:s,serializedTrx:e};u++}else if("confirmed"===t.value.confirmationStatus)return{signature:s,serializedTrx:e}}}catch(e){console.error(e)}let a=p.map(t=>t.sendRawTransaction(e,i));if(!s)try{s=await Promise.any(a)}catch(e){console.error("Transaction not submitted, remaining attempts:",r-t-1,e)}await O(1e3)}if(!s)throw Error("Failed to send transaction");return{signature:s,serializedTrx:e}}function z(e,t,n,a,i=new s.PublicKey(f.TOKEN_PROGRAM_ID),r=new s.PublicKey(f.ASSOCIATED_TOKEN_PROGRAM_ID)){let p=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:s.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new s.TransactionInstruction({keys:p,programId:r,data:u.Buffer.alloc(0)})}async function J(e,t,n,a,i,r=new s.PublicKey(f.TOKEN_PROGRAM_ID)){let p=[],o=await e.getMinimumBalanceForRentExemption(165);return p.push(s.SystemProgram.createAccount({fromPubkey:t,newAccountPubkey:i.publicKey,lamports:o,space:165,programId:r})),p.push(new s.TransactionInstruction({keys:[{pubkey:i.publicKey,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1}],programId:r,data:u.Buffer.from([1])})),p}var X=(0,m.n_)([(0,m.u8)("instruction"),(0,m.Ik)(8,"amount")]),Z=(0,m.n_)([(0,m.u8)("instruction")]);function ee(e){let t=u.Buffer.alloc(Z.span);return Z.encode({instruction:17},t),new s.TransactionInstruction({keys:[{pubkey:e,isSigner:!1,isWritable:!0}],programId:new s.PublicKey(f.TOKEN_PROGRAM_ID),data:t})}(0,m.n_)([(0,m.u8)("instruction")]);var et=(0,m.n_)([(0,m.u8)("instruction"),(0,m.Ik)(8,"amount")]);function en(e,t,n,a,i=new s.PublicKey(f.TOKEN_PROGRAM_ID)){let r=u.Buffer.alloc(et.span);return et.encode({instruction:3,amount:_(a)},r),new s.TransactionInstruction({keys:[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],programId:i,data:r})}var ea=new s.PublicKey("So11111111111111111111111111111111111111112");function ei(e){return new s.TransactionInstruction({programId:new s.PublicKey(e.programId),keys:e.accounts.map(e=>({pubkey:new s.PublicKey(e.pubkey),isSigner:e.isSigner,isWritable:e.isWritable})),data:u.Buffer.from(e.data,"base64")})}async function er(e,t){return(await t.getMultipleAccountsInfo(e.map(e=>new s.PublicKey(e)))).reduce((t,n,a)=>{let i=e[a];if(n){let e=new s.AddressLookupTableAccount({key:new s.PublicKey(i),state:s.AddressLookupTableAccount.deserialize(n.data)});t.push(e)}return t},[])}function es(e,t){let n=ei(e.swapInstruction);return{swapInstruction:n,cleanupInstruction:e.cleanupInstruction?ei(e.cleanupInstruction):null,computeBudgetInstructions:e.computeBudgetInstructions?e.computeBudgetInstructions.map(ei):[],setupInstructions:e.setupInstructions?e.setupInstructions.map(ei):[],addressLookupTableAddresses:e.addressLookupTableAddresses}}function eu(e){let t=`global:${e}`;return u.Buffer.from(d.sha256.digest(t)).subarray(0,8)}async function ep(){let e;try{let t=await K();e=new s.PublicKey(t)}catch(t){console.log("Relayer not found, using system program"),e=s.SystemProgram.programId}return e}async function eo(e,t,n=!1){try{let n=[];for(let t of e)n.push(t.serialize());let a={jsonrpc:"2.0",id:1,method:"sendBundle",params:[n.map(e=>c.Z.encode(e))]},i=await fetch(t.jitoSendUrl||"https://mainnet.block-engine.jito.wtf/api/v1/bundles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(200===i.status||201===i.status)return(await i.json()).result;throw Error("Send Jito bundle failed")}catch(e){if(console.error("Send Jito bundle failed",e),n)throw e}}async function ey(e,t){let n=0;for(;n<5;)try{let n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"getBundleStatuses",params:[e]})});if(!n.ok)throw Error(`HTTP error! Status: ${n.status}`);let a=await n.json();if(a.error)throw Error(`Error getting bundle statuses: ${JSON.stringify(a.error,null,2)}`);return a.result}catch(e){if(n++,await O(400),n>=5)throw Error(`Failed to fetch bundle statuses after 5 attempts: ${e.message}`)}}async function el(e,t,n,a,i){let r=Date.now();for(;Date.now()-r<9e4&&await i.getBlockHeight()<=n;){await O(350);let n=await ey([e],t.jitoSendUrl||"https://mainnet.block-engine.jito.wtf/api/v1/bundles");if(n&&n.value&&n.value.length>0&&n.value[0]){console.log("===>",n.value[0]);let e=n.value[0].confirmation_status;if("confirmed"===e||"finalized"===e){let e=await i.getSignatureStatus(a);if(!e||!e.value)continue;if(e.value?.err)throw Error(`Bundle failed with error: ${e.value.err}`);return}}}throw Error("Bundle not confirmed, timeout")}async function em(e){try{await fetch("https://explorer-api.mayan.finance/v3/submit/jito-bundle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bundleId:e})})}catch{}}function ed(e,t,n){!function(e){e.forEach(e=>{if(!e.programId.equals(s.ComputeBudgetProgram.programId))throw Error("Invalid compute budget instruction:: programId");if(3===Uint8Array.from(e.data)[0]&&e.data.readBigUInt64LE(1)>100000000n)throw Error("Invalid compute budget instruction:: to high tx fee")})}(e.computeBudgetInstructions),function(e,t){if(!(e.length<1)){if(e.length>6)throw Error("Invalid setup instruction:: too many instructions");e.forEach(e=>{if(!e.programId.equals(new s.PublicKey(f.ASSOCIATED_TOKEN_PROGRAM_ID))&&!e.programId.equals(s.SystemProgram.programId)&&!e.programId.equals(new s.PublicKey(f.TOKEN_PROGRAM_ID))&&!e.programId.equals(new s.PublicKey(f.TOKEN_2022_PROGRAM_ID)))throw Error("Invalid setup instruction:: programId");if(e.programId.equals(new s.PublicKey(f.ASSOCIATED_TOKEN_PROGRAM_ID))){if(1===Uint8Array.from(e.data).length){if(1!==Uint8Array.from(e.data)[0])throw Error("Invalid setup instruction:: data")}else if(0!==Uint8Array.from(e.data).length)throw Error("Invalid setup instruction:: data")}else if(e.programId.equals(s.SystemProgram.programId)){if(!t)throw Error("Invalid setup instruction:: unknown transfer");let n=w(ea,t,!0);if(2!==e.data.readUint32LE())throw Error("Invalid setup instruction:: invalid system program instruction");if(!e.keys[1].pubkey.equals(n))throw Error("Invalid setup instruction:: invalid wrap transfer dest")}else if("EQ=="!==e.data.toString("base64"))throw Error("Invalid setup instruction:: invalid token program instruction")})}}(e.setupInstructions,n),function(e,t){if(!e.programId.equals(new s.PublicKey("JUP6LkbZbjS1jKKwapdHNy74zcZ3tLUZoi5QNyVTaV4")))throw Error("Invalid swap instruction:: programId");if(e.data.subarray(0,8).toString("hex")===eu("shared_accounts_route").toString("hex")){if(!e.keys[6].pubkey.equals(t))throw Error("Invalid swap instruction shared_accounts_route:: dest account")}else if(e.data.subarray(0,8).toString("hex")===eu("route").toString("hex")){if(!e.keys[4].pubkey.equals(t))throw Error("Invalid swap instruction route:: dest account")}else throw Error("Invalid swap instruction:: ix id")}(e.swapInstruction,t),function(e){if(e){if(!e.programId.equals(new s.PublicKey(f.TOKEN_PROGRAM_ID))&&!e.programId.equals(new s.PublicKey(f.TOKEN_2022_PROGRAM_ID)))throw Error("Invalid cleanup instruction:: programId");if(1!==Uint8Array.from(e.data).length||9!==Uint8Array.from(e.data)[0])throw Error("Invalid cleanup instruction:: data")}}(e.cleanupInstruction)}function ec(e,t,n,a,i,r=new s.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA")){return new s.TransactionInstruction({keys:[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1}],programId:new s.PublicKey("B96dV3Luxzo6SokJx3xt8i5y8Mb7HRR6Eec8hCjJDT69"),data:eu("transfer_all_and_close")})}var eb=(0,m.n_)([(0,m.Ik)(8,"instruction")]);function ef(e,t,n,a,i){let r;let p=new s.PublicKey(f.WORMHOLE_PROGRAM_ID),o=new s.PublicKey(f.TOKEN_PROGRAM_ID),y=new s.PublicKey(f.CCTP_CORE_PROGRAM_ID),l=new s.PublicKey(f.CCTP_TOKEN_PROGRAM_ID),m=new s.PublicKey(f.MCTP_PROGRAM_ID),d=new s.PublicKey(a),c=new s.PublicKey(n),b=w(c,e,!0);r=i&&i>BigInt(0)?w(c,d,!1):new s.PublicKey(f.MCTP_PROGRAM_ID);let T=q(c,t),g=function(e){let t=new s.PublicKey(f.WORMHOLE_PROGRAM_ID),n=new s.PublicKey(e),[a]=s.PublicKey.findProgramAddressSync([u.Buffer.from("Bridge")],t),[i]=s.PublicKey.findProgramAddressSync([u.Buffer.from("emitter")],n),[r]=s.PublicKey.findProgramAddressSync([u.Buffer.from("Sequence"),i.toBuffer()],t),[p]=s.PublicKey.findProgramAddressSync([u.Buffer.from("fee_collector")],t);return{bridgeConfig:a,sequenceKey:r,feeCollector:p,emitter:i}}(f.MCTP_PROGRAM_ID),h=s.Keypair.generate(),I=s.Keypair.generate(),A=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:b,isWritable:!0,isSigner:!1},{pubkey:d,isWritable:!0,isSigner:!0},{pubkey:r,isWritable:!0,isSigner:!1},{pubkey:c,isWritable:!0,isSigner:!1},{pubkey:T.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:T.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:T.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:T.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:T.localToken,isWritable:!0,isSigner:!1},{pubkey:T.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:T.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:h.publicKey,isWritable:!0,isSigner:!0},{pubkey:l,isWritable:!1,isSigner:!1},{pubkey:y,isWritable:!1,isSigner:!1},{pubkey:g.emitter,isWritable:!1,isSigner:!1},{pubkey:g.bridgeConfig,isWritable:!0,isSigner:!1},{pubkey:g.sequenceKey,isWritable:!0,isSigner:!1},{pubkey:g.feeCollector,isWritable:!0,isSigner:!1},{pubkey:I.publicKey,isWritable:!0,isSigner:!0},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],M=u.Buffer.alloc(eb.span);return eb.encode({instruction:eu("bridge_with_fee")},M),{instruction:new s.TransactionInstruction({keys:A,data:M,programId:m}),signers:[h,I]}}var eT=(0,m.n_)([(0,m.Ik)(8,"instruction")]);function eg(e,t,n,a,i){let r;let p=[],o=new s.PublicKey(f.TOKEN_PROGRAM_ID),y=new s.PublicKey(f.ASSOCIATED_TOKEN_PROGRAM_ID),l=new s.PublicKey(f.CCTP_CORE_PROGRAM_ID),m=new s.PublicKey(f.CCTP_TOKEN_PROGRAM_ID),d=new s.PublicKey(f.MCTP_PROGRAM_ID),c=new s.PublicKey(a),b=new s.PublicKey(n),T=w(b,e,!0),g=q(b,t),h=s.Keypair.generate(),[I]=s.PublicKey.findProgramAddressSync([u.Buffer.from("LOCKED_FEE"),b.toBuffer(),h.publicKey.toBytes()],d);r=i&&i>BigInt(0)?w(b,c,!1):new s.PublicKey(f.MCTP_PROGRAM_ID);let A=w(b,I,!0);p.push(z(c,A,I,b));let M=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:T,isWritable:!0,isSigner:!1},{pubkey:c,isWritable:!0,isSigner:!0},{pubkey:r,isWritable:!0,isSigner:!1},{pubkey:I,isWritable:!0,isSigner:!1},{pubkey:A,isWritable:!0,isSigner:!1},{pubkey:b,isWritable:!0,isSigner:!1},{pubkey:g.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:g.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:g.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:g.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:g.localToken,isWritable:!0,isSigner:!1},{pubkey:g.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:g.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:h.publicKey,isWritable:!0,isSigner:!0},{pubkey:m,isWritable:!1,isSigner:!1},{pubkey:l,isWritable:!1,isSigner:!1},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:y,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],k=u.Buffer.alloc(eT.span);return eT.encode({instruction:eu("bridge_locked_fee")},k),p.push(new s.TransactionInstruction({keys:M,data:k,programId:d})),{instructions:p,signer:h}}var eh=(0,m.n_)([(0,m.Ik)(8,"instruction")]);function eI(e,t,n,a,i){let r;let p=new s.PublicKey(f.TOKEN_PROGRAM_ID),o=new s.PublicKey(f.CCTP_CORE_PROGRAM_ID),y=new s.PublicKey(f.CCTP_TOKEN_PROGRAM_ID),l=new s.PublicKey(f.MCTP_PROGRAM_ID),m=new s.PublicKey(a),d=new s.PublicKey(n),c=w(d,e,!0),b=q(d,t),T=s.Keypair.generate(),[g]=s.PublicKey.findProgramAddressSync([u.Buffer.from("ORDER_SOLANA_SOURCE"),e.toBuffer()],l);r=i&&i>BigInt(0)?w(d,m,!1):new s.PublicKey(f.MCTP_PROGRAM_ID);let h=[{pubkey:e,isWritable:!1,isSigner:!1},{pubkey:c,isWritable:!0,isSigner:!1},{pubkey:m,isWritable:!0,isSigner:!0},{pubkey:r,isWritable:!0,isSigner:!1},{pubkey:d,isWritable:!0,isSigner:!1},{pubkey:g,isWritable:!0,isSigner:!1},{pubkey:b.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:b.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:b.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:b.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:b.localToken,isWritable:!0,isSigner:!1},{pubkey:b.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:b.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:T.publicKey,isWritable:!0,isSigner:!0},{pubkey:y,isWritable:!1,isSigner:!1},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(f.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],I=u.Buffer.alloc(eh.span);return eh.encode({instruction:eu("create_order")},I),{instruction:new s.TransactionInstruction({keys:h,data:I,programId:l}),signer:T}}var ew=(0,m.n_)([(0,m.Ik)(8,"instruction"),(0,m.Ik)(32,"destAddress"),(0,m.Ik)(8,"amountInMin"),(0,m.Ik)(8,"gasDrop"),(0,m.Ik)(8,"feeRedeem"),(0,m.Ik)(8,"feeSolana"),(0,m.KB)("destinationChain"),(0,m.Ik)(32,"keyRnd"),(0,m.u8)("mode")]);function eA(e){if("WITH_FEE"!==e.mode&&"LOCK_FEE"!==e.mode)throw Error("Invalid mode: "+e.mode);let t=new s.PublicKey(e.swapperAddress),n=new s.PublicKey(e.mintAddress),a=w(n,e.ledger,!0),i=M[e.toChain],r=u.Buffer.from(I(h(e.destinationAddress,i))),p=_(e.amountInMin64),o=_(A(e.gasDrop,Math.min(S(e.toChain),8))),y=_(A(e.feeRedeem,6)),l=_(e.feeSolana),m=e.referrerAddress?u.Buffer.from(I(h(e.referrerAddress,i))):s.SystemProgram.programId.toBuffer(),d=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:e.customPayload||new s.PublicKey(f.MCTP_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(m),isWritable:!1,isSigner:!1}],c=u.Buffer.alloc(ew.span);return ew.encode({instruction:eu("init_bridge_ledger"),destAddress:r,amountInMin:p,gasDrop:o,feeRedeem:y,feeSolana:l,destinationChain:i,keyRnd:e.randomKey.toBuffer(),mode:"WITH_FEE"===e.mode?1:2},c),new s.TransactionInstruction({keys:d,data:c,programId:new s.PublicKey(f.MCTP_PROGRAM_ID)})}var eM=(0,m.n_)([(0,m.Ik)(8,"instruction"),(0,m.Ik)(32,"destAddress"),(0,m.Ik)(8,"amountInMin"),(0,m.Ik)(8,"gasDrop"),(0,m.Ik)(8,"feeRedeem"),(0,m.Ik)(8,"feeSolana"),(0,m.KB)("destinationChain"),(0,m.Ik)(32,"keyRnd"),(0,m.u8)("mode"),(0,m.Ik)(32,"tokenOut"),(0,m.Ik)(8,"amountOutMin"),(0,m.Ik)(8,"deadline"),(0,m.Ik)(32,"refAddress"),(0,m.u8)("feeRateRef")]);function ek(e){let t=new s.PublicKey(e.swapperAddress),n=new s.PublicKey(e.mintAddress),a=w(n,e.ledger,!0),i=M[e.toChain],r=u.Buffer.from(I(h(e.destinationAddress,i))),p=_(e.amountInMin64),o=_(A(e.gasDrop,Math.min(S(e.toChain),8))),y=_(A(e.feeRedeem,6)),l=_(e.feeSolana),m=u.Buffer.from(I(h(e.tokenOut,i))),d=e.referrerAddress?u.Buffer.from(I(h(e.referrerAddress,i))):s.SystemProgram.programId.toBuffer(),c=_(A(e.amountOutMin,Math.min(8,e.tokenOutDecimals))),b=_(e.deadline),T=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],g=u.Buffer.alloc(eM.span);return eM.encode({instruction:eu("init_order_ledger"),destAddress:r,amountInMin:p,gasDrop:o,feeRedeem:y,feeSolana:l,destinationChain:i,keyRnd:e.randomKey.toBuffer(),mode:3,tokenOut:m,refAddress:d,amountOutMin:c,deadline:b,feeRateRef:e.feeRateRef},g),new s.TransactionInstruction({keys:T,data:g,programId:new s.PublicKey(f.MCTP_PROGRAM_ID)})}async function eC(e,t,n,a,i,r={}){let p=r?.forceSkipCctpInstructions||!1,o=r?.allowSwapperOffCurve||!1;if("solana"===e.toChain)throw Error("Unsupported destination chain: "+e.toChain);let y=[],l=[],m=[],d=[],c=[],b=[],T=[],g=s.Keypair.generate(),h=null;y.push(f.LOOKUP_TABLE);let I=new s.PublicKey(f.MCTP_PROGRAM_ID),M=new s.PublicKey(t),k=s.Keypair.generate(),C=e.deadline64?BigInt(e.deadline64):BigInt(0);if(e.hasAuction&&!Number(e.deadline64))throw Error("Swap mode requires a timeout");let P=e.hasAuction?"LEDGER_ORDER":"LEDGER_BRIDGE",[S]=s.PublicKey.findProgramAddressSync([u.Buffer.from(P),M.toBytes(),k.publicKey.toBytes()],I),R=w(new s.PublicKey(e.mctpInputContract),S,!0),_="solana"===e.cheaperChain?"LOCK_FEE":"WITH_FEE",E="sui"===e.toChain?e.toToken.verifiedAddress:e.toToken.contract;if(e.fromToken.contract===e.mctpInputContract){let i=p?BigInt(e.solanaRelayerFee64):BigInt(0);if(e.suggestedPriorityFee>0&&l.push(s.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),l.push(z(M,R,S,new s.PublicKey(e.mctpInputContract))),l.push(en(w(new s.PublicKey(e.mctpInputContract),M,o),R,M,BigInt(e.effectiveAmountIn64))),e.hasAuction){if(l.push(ek({ledger:S,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:k.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:i,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),tokenOut:E,tokenOutDecimals:e.toToken.decimals,referrerAddress:a,amountOutMin:e.minAmountOut,deadline:C,feeRateRef:e.referrerBps})),!p){let{instruction:n,signer:a}=eI(S,e.toChain,e.mctpInputContract,t,i);l.push(n),m.push(a)}}else if(l.push(eA({ledger:S,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:k.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:i,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),mode:_,referrerAddress:a})),!p){if("WITH_FEE"===_){let{instruction:n,signers:a}=ef(S,e.toChain,e.mctpInputContract,t,i);l.push(n),m.push(...a)}else{let{instructions:n,signer:a}=eg(S,e.toChain,e.mctpInputContract,t,i);l.push(...n),m.push(a)}}}else{let u=await N({minMiddleAmount:e.minMiddleAmount,middleToken:e.mctpInputContract,userWallet:t,userLedger:S.toString(),slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.hasAuction?"SWAP":_,fillMaxAccounts:r?.separateSwapTx||!1,tpmTokenAccount:r?.separateSwapTx?g.publicKey.toString():null}),p=es(u,i);r?.separateSwapTx&&u.maxAccountsFilled?(ed(p,g.publicKey,M),T=await J(i,M,new s.PublicKey(e.mctpInputContract),M,g),b.push(...p.computeBudgetInstructions),p.setupInstructions&&b.push(...p.setupInstructions),b.push(p.swapInstruction),p.cleanupInstruction&&b.push(p.cleanupInstruction),c.push(...p.addressLookupTableAddresses),l.push(z(M,R,S,new s.PublicKey(e.mctpInputContract))),l.push(ec(M,new s.PublicKey(e.mctpInputContract),g.publicKey,R,M))):(ed(p,R,M),l.push(...p.computeBudgetInstructions),p.setupInstructions&&l.push(...p.setupInstructions),l.push(p.swapInstruction),p.cleanupInstruction&&l.push(p.cleanupInstruction),y.push(...p.addressLookupTableAddresses));let o=b.length>0?BigInt(0):BigInt(e.solanaRelayerFee64);if(e.hasAuction){if(l.push(ek({ledger:S,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:k.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:o,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:A(e.minMiddleAmount,6),tokenOut:E,tokenOutDecimals:e.toToken.decimals,referrerAddress:a,amountOutMin:e.minAmountOut,deadline:C,feeRateRef:e.referrerBps})),b.length>0){let{instruction:n,signer:a}=eI(S,e.toChain,e.mctpInputContract,t,o);l.push(n),m.push(a)}}else if(l.push(eA({ledger:S,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:k.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:o,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:A(e.minMiddleAmount,6),mode:_,referrerAddress:a})),b.length>0){if("WITH_FEE"===_){let{instruction:n,signers:a}=ef(S,e.toChain,e.mctpInputContract,t,o);l.push(n),m.push(...a)}else{let{instructions:n,signer:a}=eg(S,e.toChain,e.mctpInputContract,t,o);l.push(...n),m.push(a)}}}let O=await er(y.concat(c),i);return d=O.slice(0,y.length),b.length>0&&(h={messageV0:{payerKey:M,instructions:b,addressLookupTableAccounts:O.slice(y.length)},createTmpTokenAccountIxs:T,tmpTokenAccount:g}),{instructions:l,signers:m,lookupTables:d,swapMessageV0Params:h}}var eP=(0,m.n_)([(0,m.Ik)(8,"instruction"),(0,m.Ik)(8,"amountInMin"),(0,m.u8)("nativeInput"),(0,m.Ik)(8,"feeSubmit"),(0,m.Ik)(32,"destAddress"),(0,m.KB)("destinationChain"),(0,m.Ik)(32,"tokenOut"),(0,m.Ik)(8,"amountOutMin"),(0,m.Ik)(8,"gasDrop"),(0,m.Ik)(8,"feeCancel"),(0,m.Ik)(8,"feeRefund"),(0,m.Ik)(8,"deadline"),(0,m.Ik)(32,"refAddress"),(0,m.u8)("feeRateRef"),(0,m.u8)("feeRateMayan"),(0,m.u8)("auctionMode"),(0,m.Ik)(32,"randomKey")]);async function eS(e,t,n,a,i,r={}){if("SWIFT"!==e.type)throw Error("Unsupported quote type for Swift: "+e.type);if("solana"===e.toChain)throw Error("Unsupported destination chain: "+e.toChain);let p=r.allowSwapperOffCurve||!1,y=[],l=[],m=[];m.push(f.LOOKUP_TABLE);let d=[],c=[],T=[],g=s.Keypair.generate(),k=null,C=new s.PublicKey(f.SWIFT_PROGRAM_ID),P=new s.PublicKey(t),R=s.Keypair.generate();if(!Number(e.deadline64))throw Error("Swift mode requires a timeout");let E=BigInt(e.deadline64),O=function(e,t,n,a,i){let r=u.Buffer.alloc(239),p=0,y=M[e.fromChain],l=u.Buffer.from(I(h(t,y)));r.set(l,0),p+=32,r.writeUInt16BE(y,p),p+=2;let m=e.swiftInputContract===o.N?h(s.SystemProgram.programId.toString(),M.solana):h(e.swiftInputContract,y),d=u.Buffer.from(I(m));r.set(d,p),p+=32;let c=M[e.toChain],f=u.Buffer.from(I(h(n,c)));r.set(f,p),p+=32,r.writeUInt16BE(c,p),p+=2;let T=e.toToken.contract===o.N?h(s.SystemProgram.programId.toString(),M.solana):h(e.toToken.contract,c),g=u.Buffer.from(I(T));r.set(g,p),p+=32,r.writeBigUInt64BE(A(e.minAmountOut,Math.min(e.toToken.decimals,8)),p),p+=8,r.writeBigUInt64BE(A(e.gasDrop,Math.min(S(e.toChain),8)),p),p+=8,r.writeBigUInt64BE(BigInt(e.cancelRelayerFee64),p),p+=8,r.writeBigUInt64BE(BigInt(e.refundRelayerFee64),p),p+=8,r.writeBigUInt64BE(BigInt(e.deadline64),p),p+=8;let w=a?u.Buffer.from(I(h(a,c))):s.SystemProgram.programId.toBuffer();r.set(w,p),p+=32,r.writeUInt8(e.referrerBps,p),p+=1;let k=e.protocolBps;r.writeUInt8(k,p),p+=1,r.writeUInt8(e.swiftAuctionMode,p),p+=1;let C=u.Buffer.from(I(i));if(r.set(C,p),239!==(p+=32))throw Error(`Invalid order data size: ${p}`);let P=b.w(r);return u.Buffer.from(I(P))}(e,t,n,a,R.publicKey.toBuffer().toString("hex")),[F]=s.PublicKey.findProgramAddressSync([u.Buffer.from("STATE_SOURCE"),O],C),D=e.swiftInputContract===o.N?ea:new s.PublicKey(e.swiftInputContract),B=w(D,F,!0),v=e.gasless?new s.PublicKey(e.relayer):P,K=w(D,v,!1);if(e.fromToken.contract===e.swiftInputContract)e.suggestedPriorityFee>0&&y.push(s.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),y.push(z(v,B,F,D)),e.swiftInputContract===o.N?y.push(s.SystemProgram.transfer({fromPubkey:P,toPubkey:B,lamports:BigInt(e.effectiveAmountIn64)}),ee(B)):y.push(en(w(D,P,p),B,P,BigInt(e.effectiveAmountIn64)));else{let n=await N({minMiddleAmount:e.minMiddleAmount,middleToken:e.swiftInputContract,userWallet:t,slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.gasless?"SWIFT_GASLESS":"SWIFT",orderHash:`0x${O.toString("hex")}`,fillMaxAccounts:r?.separateSwapTx||!1,tpmTokenAccount:r?.separateSwapTx?g.publicKey.toString():null}),a=es(n,i);r?.separateSwapTx&&n.maxAccountsFilled?(ed(a,g.publicKey,P),T=await J(i,v,D,P,g),c.push(...a.computeBudgetInstructions),a.setupInstructions&&c.push(...a.setupInstructions),c.push(a.swapInstruction),a.cleanupInstruction&&c.push(a.cleanupInstruction),d.push(...a.addressLookupTableAddresses),y.push(z(v,B,F,D)),y.push(ec(P,D,g.publicKey,B,v))):(y.push(...a.computeBudgetInstructions),a.setupInstructions&&y.push(...a.setupInstructions),y.push(a.swapInstruction),a.cleanupInstruction&&y.push(a.cleanupInstruction),m.push(...a.addressLookupTableAddresses))}y.push(function(e){let{quote:t}=e,n=t.swiftInputContract===o.N?ea:new s.PublicKey(t.swiftInputContract),a=M[t.toChain];if(a!==t.toToken.wChainId)throw Error(`Destination chain ID mismatch: ${a} != ${t.toToken.wChainId}`);let i=[{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.relayer,isWritable:!0,isSigner:!0},{pubkey:e.state,isWritable:!0,isSigner:!1},{pubkey:e.stateAccount,isWritable:!0,isSigner:!1},{pubkey:e.relayerAccount,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(f.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:new s.PublicKey(f.TOKEN_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],r=u.Buffer.alloc(eP.span),p=e.referrerAddress?u.Buffer.from(I(h(e.referrerAddress,a))):s.SystemProgram.programId.toBuffer(),y=t.fromToken.contract===t.swiftInputContract?BigInt(t.effectiveAmountIn64):A(t.minMiddleAmount,t.swiftInputDecimals);return eP.encode({instruction:eu("init_order"),amountInMin:_(y),nativeInput:t.swiftInputContract===o.N?1:0,feeSubmit:_(BigInt(t.submitRelayerFee64)),destAddress:u.Buffer.from(I(h(e.destinationAddress,a))),destinationChain:a,tokenOut:u.Buffer.from(I(h(t.toToken.contract,a))),amountOutMin:_(A(t.minAmountOut,Math.min(t.toToken.decimals,8))),gasDrop:_(A(t.gasDrop,Math.min(S(t.toChain),8))),feeCancel:_(BigInt(t.cancelRelayerFee64)),feeRefund:_(BigInt(t.refundRelayerFee64)),deadline:_(e.deadline),refAddress:p,feeRateRef:t.referrerBps,feeRateMayan:t.protocolBps,auctionMode:t.swiftAuctionMode,randomKey:e.randomKey.toBuffer()},r),new s.TransactionInstruction({keys:i,data:r,programId:new s.PublicKey(f.SWIFT_PROGRAM_ID)})}({quote:e,state:F,trader:P,stateAccount:B,randomKey:R.publicKey,relayerAccount:K,relayer:v,destinationAddress:n,deadline:E,referrerAddress:a}));let W=await er(m.concat(d),i);return l=W.slice(0,m.length),c.length>0&&(k={messageV0:{payerKey:v,instructions:c,addressLookupTableAccounts:W.slice(m.length)},createTmpTokenAccountIxs:T,tmpTokenAccount:g}),{instructions:y,signers:[],lookupTables:l,swapMessageV0Params:k}}var eR=(0,m.n_)([(0,m.u8)("instruction"),(0,m.u8)("stateNonce"),(0,m.Ik)(8,"amount"),(0,m.Ik)(8,"minAmountOut"),(0,m.Ik)(8,"deadline"),(0,m.Ik)(8,"feeSwap"),(0,m.Ik)(8,"feeReturn"),(0,m.Ik)(8,"feeCancel"),(0,m.Ik)(8,"gasDrop"),(0,m.KB)("destinationChain"),(0,m.Ik)(32,"destinationAddress"),(0,m.u8)("unwrapRedeem"),(0,m.u8)("unwrapRefund"),(0,m.u8)("mayanFeeNonce"),(0,m.u8)("referrerFeeNonce")]);async function e_(e,t,n,a,i,r={}){let p;let y=F(e,a);if("MCTP"===e.type)return eC(e,t,n,y,i,r);if("SWIFT"===e.type)return eS(e,t,n,y,i,r);let l=[],m=i??new s.Connection("https://rpc.ankr.com/solana"),d=new s.PublicKey(f.MAYAN_PROGRAM_ID),c=new s.PublicKey(f.TOKEN_PROGRAM_ID),b=new s.PublicKey(t),T=new s.PublicKey(f.AUCTION_PROGRAM_ID);e.suggestedPriorityFee>0&&l.push(s.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),p=y?new s.PublicKey(y):s.SystemProgram.programId;let[g,k]=s.PublicKey.findProgramAddressSync([u.Buffer.from("MAYANFEE")],d),[C,P]=s.PublicKey.findProgramAddressSync([u.Buffer.from("REFERRERFEE"),p.toBuffer()],d),S=s.Keypair.generate(),R=s.Keypair.generate(),[E,O]=s.PublicKey.findProgramAddressSync([u.Buffer.from("V2STATE"),u.Buffer.from(S.publicKey.toBytes()),u.Buffer.from(R.publicKey.toBytes())],d),D=new s.PublicKey(e.fromToken.mint),B=new s.PublicKey(e.toToken.mint),v=w(D,b),K=w(D,E,!0),[[N,W],x,U]=await Promise.all([m.getMultipleAccountsInfo([v,K],"finalized"),m.getMinimumBalanceForRentExemption(420),ep()]);N&&0!==N.data.length||l.push(z(b,v,b,D)),W&&0!==W.data.length||l.push(z(b,K,E,D)),e.fromToken.contract===o.N&&(l.push(s.SystemProgram.transfer({fromPubkey:b,toPubkey:v,lamports:BigInt(e.effectiveAmountIn64)})),l.push(ee(v)));let G=BigInt(e.effectiveAmountIn64),L=s.Keypair.generate();l.push(function(e,t,n,a,i=new s.PublicKey(f.TOKEN_PROGRAM_ID)){let r=u.Buffer.alloc(X.span);return X.encode({instruction:4,amount:_(a)},r),new s.TransactionInstruction({keys:[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:i,data:r})}(v,L.publicKey,b,G)),l.push(s.SystemProgram.transfer({fromPubkey:b,toPubkey:L.publicKey,lamports:x}));let q=[{pubkey:L.publicKey,isWritable:!1,isSigner:!0},{pubkey:S.publicKey,isWritable:!1,isSigner:!0},{pubkey:R.publicKey,isWritable:!1,isSigner:!0},{pubkey:E,isWritable:!0,isSigner:!1},{pubkey:v,isWritable:!0,isSigner:!1},{pubkey:b,isWritable:!1,isSigner:!1},{pubkey:K,isWritable:!0,isSigner:!1},{pubkey:D,isWritable:!1,isSigner:!1},{pubkey:B,isWritable:!1,isSigner:!1},{pubkey:T,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:g,isWritable:!1,isSigner:!1},{pubkey:C,isWritable:!1,isSigner:!1},{pubkey:L.publicKey,isWritable:!0,isSigner:!0},{pubkey:U,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:s.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:s.SystemProgram.programId,isWritable:!1,isSigner:!1}],H=M[e.toChain];if(1===H){let e=await m.getAccountInfo(new s.PublicKey(n));if(e&&e.owner&&e.owner.equals(c))throw Error("Destination address is not about token account. It should be a owner address")}let V=u.Buffer.from(I(h(n,H))),Y=A(e.minAmountOut,e.mintDecimals.to),$=A(e.swapRelayerFee,e.mintDecimals.from),j=A(e.redeemRelayerFee,e.mintDecimals.to),Q=A(e.refundRelayerFee,e.mintDecimals.from),J=A(e.gasDrop,"solana"===e.toChain?9:8),Z=e.toToken.contract===o.N,et=e.fromToken.contract===o.N;if(!Number(e.deadline64))throw Error("Deadline is not valid");let en=BigInt(e.deadline64),ea=u.Buffer.alloc(eR.span),ei={instruction:101,stateNonce:O,amount:_(G),minAmountOut:_(Y),deadline:_(en),feeSwap:_($),feeReturn:_(j),feeCancel:_(Q),gasDrop:_(J),destinationChain:H,destinationAddress:V,unwrapRedeem:Z?1:0,unwrapRefund:et?1:0,mayanFeeNonce:k,referrerFeeNonce:P};return eR.encode(ei,ea),l.push(new s.TransactionInstruction({keys:q,data:ea,programId:d})),{instructions:l,signers:[L,S,R],lookupTables:[],swapMessageV0Params:null}}async function eE(e,t,n,a,i,r,p,o,y,l){let m;let d=r??new s.Connection("https://rpc.ankr.com/solana"),b=!!(!e.gasless&&y&&y.tipLamports>0&&y.signAllTransactions),{instructions:f,signers:T,lookupTables:g,swapMessageV0Params:h}=await e_(e,t,n,a,r,{allowSwapperOffCurve:l?.allowSwapperOffCurve,forceSkipCctpInstructions:l?.forceSkipCctpInstructions,separateSwapTx:b&&y?.separateSwapTx}),I=new s.PublicKey(t),w=e.gasless?new s.PublicKey(e.relayer):I,{blockhash:A,lastValidBlockHeight:M}=await r.getLatestBlockhash(),k=s.MessageV0.compile({instructions:f,payerKey:w,recentBlockhash:A,addressLookupTableAccounts:g}),C=new s.VersionedTransaction(k);if(C.sign(T),b){let e=[];if(h){let t=new s.Transaction({feePayer:I,blockhash:A,lastValidBlockHeight:M}).add(...h.createTmpTokenAccountIxs);t.partialSign(h.tmpTokenAccount),e.push(t);let n=s.MessageV0.compile({...h.messageV0,recentBlockhash:A});e.push(new s.VersionedTransaction(n))}let n=function(e,t,n,a){let i=a.jitoAccount||"Cw8CFyM9FkoMi7K7Crf6HNQqf4uEMzpKw6QNghXLvLkY";return new s.Transaction({feePayer:new s.PublicKey(e),blockhash:t,lastValidBlockHeight:n}).add(s.SystemProgram.transfer({fromPubkey:new s.PublicKey(e),toPubkey:new s.PublicKey(i),lamports:a.tipLamports}))}(t,A,M,y);e.push(C),e.push(n);let a=await y.signAllTransactions(e);m=a[a.length-2];let i=null;if(m instanceof s.Transaction&&m?.signatures[0]?.publicKey?i=c.Z.encode(Uint8Array.from(m.signatures[0].signature)):m instanceof s.VersionedTransaction&&m?.signatures[0]&&(i=c.Z.encode(Uint8Array.from(m.signatures[0]))),null===i)throw Error("Failed to get mayan tx hash");if(h){let e=await eo(a,y,!0);return await el(e,y,M,i,r),em(e),{signature:i,serializedTrx:null}}eo(a,y).then(()=>{console.log("Jito bundle sent")}).catch(()=>{})}else m=await i(C);if(e.gasless){let e=u.Buffer.from(m.serialize()).toString("base64"),{orderHash:t}=await W(e);return{signature:t,serializedTrx:null}}return await Q({trx:m.serialize(),connection:d,extraRpcs:p??[],errorChance:2,options:o})}var eO=[{type:"function",name:"batchMaxApprove",inputs:[{name:"approvals",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"initiate",inputs:[{name:"recipient",type:"bytes32",internalType:"bytes32"},{name:"overrideAmountIn",type:"uint256",internalType:"uint256"},{name:"targetChain",type:"uint16",internalType:"uint16"},{name:"params",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes",internalType:"bytes"}],stateMutability:"payable"},{type:"error",name:"ChainNotSupported",inputs:[{name:"chain",type:"uint16",internalType:"uint16"}]},{type:"error",name:"DeadlineExpired",inputs:[{name:"blocktime",type:"uint256",internalType:"uint256"},{name:"deadline",type:"uint256",internalType:"uint256"}]},{type:"error",name:"EthTransferFailed",inputs:[]},{type:"error",name:"ExceedsMaxGasDropoff",inputs:[{name:"requested",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"ExceedsMaxRelayingFee",inputs:[{name:"fee",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InsufficientInputAmount",inputs:[{name:"input",type:"uint256",internalType:"uint256"},{name:"minimum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidAddress",inputs:[{name:"addr",type:"bytes32",internalType:"bytes32"}]},{type:"error",name:"InvalidBoolVal",inputs:[{name:"val",type:"uint8",internalType:"uint8"}]},{type:"error",name:"InvalidOverrideAmount",inputs:[{name:"received",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidSwapType",inputs:[{name:"swapType",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidSwapTypeForChain",inputs:[{name:"chain",type:"uint16",internalType:"uint16"},{name:"swapType",type:"uint256",internalType:"uint256"}]},{type:"error",name:"LengthMismatch",inputs:[{name:"encodedLength",type:"uint256",internalType:"uint256"},{name:"expectedLength",type:"uint256",internalType:"uint256"}]},{type:"error",name:"RelayingDisabledForChain",inputs:[]}],eF={FAST_MODE_FLAG:1,RELAY_REDEEM_MODE:2,EXACT_IN_FLAG:1,USDC_INPUT_TOKEN_TYPE:0,PRE_APPROVED_ACQUIRE_MODE:0,OUTPUT_USDC_MODE:0,OUTPUT_NATIVE_MODE:1,OUTPUT_OTHER_MODE:2},eD=[{type:"constructor",inputs:[{name:"_cctpTokenMessengerV2",type:"address",internalType:"address"},{name:"_feeManager",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"bridge",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"redeemFee",type:"uint64",internalType:"uint64"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"referrerAddress",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"customPayload",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"cctpTokenMessengerV2",inputs:[],outputs:[{name:"",type:"address",internalType:"contract ITokenMessengerV2"}],stateMutability:"view"},{type:"function",name:"changeGuardian",inputs:[{name:"newGuardian",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"claimGuardian",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"createOrder",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"orderPayload",type:"tuple",internalType:"struct FastMCTP.OrderPayload",components:[{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"tokenOut",type:"bytes32",internalType:"bytes32"},{name:"amountOutMin",type:"uint64",internalType:"uint64"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"redeemFee",type:"uint64",internalType:"uint64"},{name:"refundFee",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"referrerAddr",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"domainToCaller",inputs:[{name:"",type:"uint32",internalType:"uint32"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"feeManager",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"fulfillOrder",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"},{name:"swapProtocol",type:"address",internalType:"address"},{name:"swapData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"guardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"keyToMintRecipient",inputs:[{name:"",type:"bytes32",internalType:"bytes32"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"nextGuardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"paused",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"redeem",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"refund",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"rescueEth",inputs:[{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address payable"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueRedeem",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueToken",inputs:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setDomainCallers",inputs:[{name:"domain",type:"uint32",internalType:"uint32"},{name:"caller",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setFeeManager",inputs:[{name:"_feeManager",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setMintRecipient",inputs:[{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"tokenIn",type:"address",internalType:"address"},{name:"mintRecipient",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setPause",inputs:[{name:"_pause",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setWhitelistedMsgSenders",inputs:[{name:"sender",type:"address",internalType:"address"},{name:"isWhitelisted",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setWhitelistedSwapProtocols",inputs:[{name:"protocol",type:"address",internalType:"address"},{name:"isWhitelisted",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"whitelistedMsgSenders",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"whitelistedSwapProtocols",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"event",name:"OrderFulfilled",inputs:[{name:"sourceDomain",type:"uint32",indexed:!1,internalType:"uint32"},{name:"sourceNonce",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"OrderRefunded",inputs:[{name:"sourceDomain",type:"uint32",indexed:!1,internalType:"uint32"},{name:"sourceNonce",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"AlreadySet",inputs:[]},{type:"error",name:"CallerNotSet",inputs:[]},{type:"error",name:"CctpReceiveFailed",inputs:[]},{type:"error",name:"DeadlineViolation",inputs:[]},{type:"error",name:"EthTransferFailed",inputs:[]},{type:"error",name:"InvalidAddress",inputs:[]},{type:"error",name:"InvalidAmountOut",inputs:[]},{type:"error",name:"InvalidGasDrop",inputs:[]},{type:"error",name:"InvalidMintRecipient",inputs:[]},{type:"error",name:"InvalidPayload",inputs:[]},{type:"error",name:"InvalidPayloadType",inputs:[]},{type:"error",name:"InvalidRedeemFee",inputs:[]},{type:"error",name:"InvalidRefundFee",inputs:[]},{type:"error",name:"MintRecipientNotSet",inputs:[]},{type:"error",name:"Paused",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]},{type:"error",name:"UnauthorizedMsgSender",inputs:[]},{type:"error",name:"UnauthorizedSwapProtocol",inputs:[]}];function eB(e,t,n,a,i){let r;let p=function(e,t,n,a,i){let r;let p=k[Number(a)],o=M[e.fromChain],y=M[e.toChain];if(o!==p)throw Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${o} !== ${p}`);let l=h(t,y),m=A(e.redeemRelayerFee,6),d=A(e.gasDrop,Math.min(S(e.toChain),8)),c=BigInt(e.circleMaxFee64),b=BigInt(e.effectiveAmountIn64),f=L(e.toChain);if(r=n?h(n,y):h(s.SystemProgram.programId.toString(),M.solana),!e.fastMctpMayanContract)throw Error("FastMctp contract address is missing");let T=e.fastMctpMayanContract;return{tokenIn:e.fastMctpInputContract,amountIn:b,redeemFee:m,gasDrop:d,destAddr:l,destDomain:f,referrerAddr:r,referrerBps:e.referrerBps,payloadType:i?2:1,customPayload:i?`0x${u.Buffer.from(i).toString("hex")}`:"0x",minFinalityThreshold:Number(e.fastMctpMinFinality),circleMaxFee:c,contractAddress:T}}(e,t,n,a,i),{contractAddress:o,tokenIn:m,amountIn:d,destAddr:c,redeemFee:b,gasDrop:f,circleMaxFee:T,referrerAddr:g,referrerBps:I,destDomain:w,customPayload:C,minFinalityThreshold:P,payloadType:R}=p;return r=new y.CH(o,eD).interface.encodeFunctionData("bridge",[m,d,b,T,f,c,w,g,I,R,P,C]),{to:o,data:r,value:(0,l.m9)(0),_params:p}}function ev(e,t,n,a){let i=function(e,t,n,a){let i;let r=k[Number(a)],u=M[e.fromChain],p=M[e.toChain];if(u!==r)throw Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${u} !== ${r}`);if(!e.fastMctpMayanContract)throw Error("MCTP contract address is missing");let y=e.fastMctpMayanContract,l=h(t,p);i=n?h(n,p):h(s.SystemProgram.programId.toString(),M.solana);let m=A(e.redeemRelayerFee,6),d=BigInt(e.refundRelayerFee64),c=BigInt(e.circleMaxFee64),b=A(e.gasDrop,Math.min(S(e.toChain),8)),f=L(e.toChain),T=BigInt(e.effectiveAmountIn64),g=A(e.minAmountOut,Math.min(8,e.toToken.decimals)),I=BigInt(e.deadline64),w=e.toToken.contract===o.N?h(s.SystemProgram.programId.toString(),M.solana):h("sui"===e.toChain?e.toToken.verifiedAddress:e.toToken.contract,e.toToken.wChainId);return{tokenIn:e.fastMctpInputContract,amountIn:T,circleMaxFee:c,destDomain:f,minFinalityThreshold:Number(e.fastMctpMinFinality),orderPayload:{payloadType:3,destAddr:l,tokenOut:w,amountOutMin:g,gasDrop:b,redeemFee:m,refundFee:d,deadline:I,referrerAddr:i,referrerBps:e.referrerBps||0},contractAddress:y}}(e,t,n,a),{contractAddress:r,orderPayload:u,tokenIn:p,amountIn:m,circleMaxFee:d,destDomain:c,minFinalityThreshold:b}=i,f=new y.CH(r,eD).interface.encodeFunctionData("createOrder",[p,m,d,c,b,u]);return{to:r,data:f,value:(0,l.m9)(0),_params:i}}function eK(e,t,n,a,i,r,p,m){let d,c,b;let T=k[Number(r)],g=M[e.fromChain];if(g!==T)throw Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${g} !== ${T}`);let I=F(e,a);if("MCTP"===e.type)return function(e,t,n,a,i,r){if("MCTP"!==e.type)throw Error("Quote type is not MCTP");if(!Number.isFinite(Number(a)))throw Error("Invalid signer chain id");a=Number(a);let s=i||E,u=new y.CH(f.MAYAN_FORWARDER_CONTRACT,U),p=A(e.bridgeFee,S(e.fromChain)),m=(0,l.m9)(p);if(e.fromToken.contract===e.mctpInputContract){if(e.hasAuction){if(!Number(e.deadline64))throw Error("MCTP order requires timeout");let i=V(e,t,n,a),r="forwardERC20",p=[e.fromToken.contract,i._params.params.amountIn,s,i._params.contractAddress,i.data];return{data:u.interface.encodeFunctionData(r,p),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(m),chainId:a,_forwarder:{method:r,params:p}}}{let n=H(e,t,a,r),i="forwardERC20",p=[e.fromToken.contract,n._params.amountIn,s,n._params.contractAddress,n.data];return{data:u.interface.encodeFunctionData(i,p),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(m),chainId:a,_forwarder:{method:i,params:p}}}}{let{minMiddleAmount:i,evmSwapRouterAddress:y,evmSwapRouterCalldata:d}=e;if(!i||!y||!d)throw Error("MCTP swap requires middle amount, router address and calldata");if(e.hasAuction){if(!Number(e.deadline64))throw Error("MCTP order requires timeout");let i=V(e,t,n,a),r=A(e.minMiddleAmount,6);if(e.fromToken.contract===o.N){let t=i._params.params.amountIn;if(t<=p)throw Error("Amount in is less than bridge fee");p!==BigInt(0)&&(t-=p),m=(0,l.m9)(i._params.params.amountIn);let n="swapAndForwardEth",s=[t,y,d,e.mctpInputContract,r,i._params.contractAddress,i.data];return{data:u.interface.encodeFunctionData(n,s),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(m),chainId:a,_forwarder:{method:n,params:s}}}{let t="swapAndForwardERC20",n=[e.fromToken.contract,i._params.params.amountIn,s,y,d,e.mctpInputContract,r,i._params.contractAddress,i.data];return{data:u.interface.encodeFunctionData(t,n),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(m),chainId:a,_forwarder:{method:t,params:n}}}}{let n=H(e,t,a,r),i=A(e.minMiddleAmount,6);if(e.fromToken.contract===o.N){let t=n._params.amountIn;if(t<=p)throw Error("Amount in is less than bridge fee");p!==BigInt(0)&&(t-=p),m=(0,l.m9)(n._params.amountIn);let r="swapAndForwardEth",s=[t,y,d,e.mctpInputContract,i,n._params.contractAddress,n.data];return{data:u.interface.encodeFunctionData(r,s),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(m),chainId:a,_forwarder:{method:r,params:s}}}{let t="swapAndForwardERC20",r=[e.fromToken.contract,n._params.amountIn,s,y,d,e.mctpInputContract,i,n._params.contractAddress,n.data];return{data:u.interface.encodeFunctionData(t,r),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(m),chainId:a,_forwarder:{method:t,params:r}}}}}}(e,n,I,r,m,p);if("SWIFT"===e.type)return function(e,t,n,a,i,r){let u,p,m,d;if("SWIFT"!==e.type)throw Error("Quote type is not SWIFT");if(!Number.isFinite(Number(i)))throw Error("Invalid signer chain id");if(!Number(e.deadline64))throw Error("Swift order requires timeout");i=Number(i);let c=r||E,b=new y.CH(f.MAYAN_FORWARDER_CONTRACT,U),{tokenIn:T,amountIn:g,order:I,contractAddress:w}=function(e,t,n,a,i){let r;let u=k[Number(i)],p=M[e.fromChain],y=M[e.toChain];if(p!==u)throw Error(`Signer chain id(${Number(i)}) and quote from chain are not same! ${p} !== ${u}`);if(!e.swiftMayanContract)throw Error("SWIFT contract address is missing");if(e.toToken.wChainId!==y)throw Error(`Destination chain ID mismatch: ${y} != ${e.toToken.wChainId}`);let l=e.swiftMayanContract;if(!Number(e.deadline64))throw Error("Swift order requires timeout");let m=BigInt(e.deadline64),d=e.swiftInputContract,c=BigInt(e.effectiveAmountIn64);r=a?h(a,y):h(s.SystemProgram.programId.toString(),1);let b=h(s.Keypair.generate().publicKey.toString(),1),f=e.toToken.contract===o.N?h(s.SystemProgram.programId.toString(),1):h(e.toToken.contract,y),T=A(e.minAmountOut,Math.min(8,e.toToken.decimals)),g=A(e.gasDrop,Math.min(8,S(e.toChain))),I=h(n,y);return{contractAddress:l,tokenIn:d,amountIn:c,order:{trader:h(t,p),tokenOut:f,minAmountOut:T,gasDrop:g,cancelFee:BigInt(e.cancelRelayerFee64),refundFee:BigInt(e.refundRelayerFee64),deadline:m,destAddr:I,destChainId:y,referrerAddr:r,referrerBps:e.referrerBps||0,auctionMode:e.swiftAuctionMode,random:b}}}(e,t,n,a,i),C=new y.CH(w,Y);if(u=e.swiftInputContract===o.N?C.interface.encodeFunctionData("createOrderWithEth",[I]):C.interface.encodeFunctionData("createOrderWithToken",[T,g,I]),e.fromToken.contract===e.swiftInputContract)e.fromToken.contract===o.N?(p="forwardEth",m=[w,u],d=(0,l.m9)(g)):(p="forwardERC20",m=[T,g,c,w,u],d=(0,l.m9)(0));else{let{evmSwapRouterAddress:t,evmSwapRouterCalldata:n}=e;if(!e.minMiddleAmount||!t||!n)throw Error("Swift swap requires middle amount, router address and calldata");let a=e.fromToken.contract,i=A(e.minMiddleAmount,e.swiftInputDecimals);e.fromToken.contract===o.N?(p="swapAndForwardEth",m=[g,t,n,e.swiftInputContract,i,w,u],d=(0,l.m9)(g)):(p="swapAndForwardERC20",m=[a,g,c,t,n,e.swiftInputContract,i,w,u],d=(0,l.m9)(0))}return{data:b.interface.encodeFunctionData(p,m),to:f.MAYAN_FORWARDER_CONTRACT,value:d,chainId:i,_forwarder:{method:p,params:m}}}(e,t,n,I,r,m);if("SHUTTLE"===e.type)return function(e,t,n,a){let i,r,s,p;if("SHUTTLE"!==e.type)throw Error("Quote type is not SHUTTLE");if(!Number.isFinite(Number(n)))throw Error("Invalid signer chain id");n=Number(n);let m=a||E,d=new y.CH(f.MAYAN_FORWARDER_CONTRACT,U),{destAddr:c,destChainId:b,serializedParams:T,contractAddress:g,amountIn:I,bridgeFee:w}=function(e,t,n){let{shuttleParams:a}=e;if(!a)throw Error("Swap layer params are missing in quote response");let i=k[Number(n)],r=M[e.fromChain],s=M[e.toChain];if(r!==i)throw Error(`Signer chain id(${Number(n)}) and quote from chain are not same! ${r} !== ${i}`);let p=[];p.push(eF.FAST_MODE_FLAG);let y=u.Buffer.alloc(8);y.writeBigUInt64BE(BigInt(a.maxLLFee));let l=y.subarray(2);p.push(...l);let m=u.Buffer.alloc(4);m.writeUInt32BE(a.fastTransferDeadline),p.push(...m),p.push(eF.RELAY_REDEEM_MODE);let d=A(e.gasDrop,Math.min(6,S(e.toChain))),c=u.Buffer.alloc(8);c.writeBigUInt64BE(d);let b=c.subarray(4);p.push(...b);let f=u.Buffer.alloc(8);f.writeBigUInt64BE(BigInt(a.maxRelayingFee));let T=f.subarray(2);p.push(...T),p.push(eF.EXACT_IN_FLAG),p.push(eF.USDC_INPUT_TOKEN_TYPE);let g=BigInt(e.effectiveAmountIn64);if(e.fromToken.contract===e.shuttleInputContract){p.push(...Array(8).fill(0));let e=u.Buffer.alloc(8);e.writeBigUInt64BE(g),p.push(...e)}else p.push(...Array(16).fill(0));if(p.push(eF.PRE_APPROVED_ACQUIRE_MODE),a.hasDestSwap){if(e.toToken.contract===o.N)p.push(eF.OUTPUT_NATIVE_MODE);else{p.push(eF.OUTPUT_OTHER_MODE);let t=u.Buffer.from(h(e.toToken.contract,s).slice(2),"hex");p.push(...t)}let t=u.Buffer.alloc(4);t.writeUInt32BE(Number(BigInt(e.deadline64))),p.push(...t);let n=A(e.minAmountOut,e.toToken.decimals);if("solana"===e.toChain){p.push(...Array(8).fill(0));let e=u.Buffer.alloc(8);e.writeBigUInt64BE(n),p.push(...e)}else{let e=function(e){if(e<0n||e>(1n<<128n)-1n)throw RangeError("Value must fit in an unsigned 128-bit integer (0 <= value < 2^128)");let t=u.Buffer.alloc(16);for(let n=15;n>=0;n--)t[n]=Number(255n&e),e>>=8n;return t}(n);p.push(...e)}let i=u.Buffer.from(a.path.slice(2),"hex");p.push(...i)}else p.push(eF.OUTPUT_USDC_MODE);return{destAddr:h(t,s),destChainId:s,serializedParams:`0x${u.Buffer.from(p).toString("hex")}`,contractAddress:e.shuttleContract,amountIn:g,bridgeFee:A(e.bridgeFee,S(e.fromChain))}}(e,t,n);if(i=new y.CH(g,eO).interface.encodeFunctionData("initiate",[c,I,b,T]),e.fromToken.contract===e.shuttleInputContract)r="forwardERC20",s=[e.shuttleInputContract,I,m,g,i],p=(0,l.m9)(w);else{let{evmSwapRouterAddress:t,evmSwapRouterCalldata:n}=e;if(!e.minMiddleAmount||!t||!n)throw Error("Shuttle source chain swap requires middle amount, router address and calldata");let a=e.fromToken.contract,u=A(e.minMiddleAmount,e.shuttleInputDecimals);e.fromToken.contract===o.N?(r="swapAndForwardEth",s=[I,t,n,e.shuttleInputContract,u,g,i],p=(0,l.m9)(I)):(r="swapAndForwardERC20",s=[a,I,m,t,n,e.shuttleInputContract,u,g,i],p=(0,l.m9)(w))}return{data:d.interface.encodeFunctionData(r,s),to:f.MAYAN_FORWARDER_CONTRACT,value:p,chainId:n,_forwarder:{method:r,params:s}}}(e,n,r,m);if("FAST_MCTP"===e.type)return function(e,t,n,a,i,r){if("FAST_MCTP"!==e.type)throw Error("Quote type is not FAST_MCTP");if(!Number.isFinite(Number(a)))throw Error("Invalid signer chain id");a=Number(a);let s=i||E,u=new y.CH(f.MAYAN_FORWARDER_CONTRACT,U);if(e.fromToken.contract===e.fastMctpInputContract){if(e.hasAuction){if(!Number(e.deadline64))throw Error("Fast Mctp order requires timeout");let i=ev(e,t,n,a),r="forwardERC20",p=[e.fromToken.contract,i._params.amountIn,s,i._params.contractAddress,i.data];return{data:u.interface.encodeFunctionData(r,p),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:a,_forwarder:{method:r,params:p}}}{let i=eB(e,t,n,a,r),p="forwardERC20",o=[e.fromToken.contract,i._params.amountIn,s,i._params.contractAddress,i.data];return{data:u.interface.encodeFunctionData(p,o),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:a,_forwarder:{method:p,params:o}}}}{let{minMiddleAmount:i,evmSwapRouterAddress:p,evmSwapRouterCalldata:y}=e;if(!i||!p||!y)throw Error("Fast Mctp swap requires middle amount, router address and calldata");if(e.hasAuction){if(!Number(e.deadline64))throw Error("Fast Mctp order requires timeout");let i=ev(e,t,n,a),r=A(e.minMiddleAmount,6);if(e.fromToken.contract===o.N){let t="swapAndForwardEth",n=[i._params.amountIn,p,y,e.fastMctpInputContract,r,i._params.contractAddress,i.data];return{data:u.interface.encodeFunctionData(t,n),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(i._params.amountIn),chainId:a,_forwarder:{method:t,params:n}}}{let t="swapAndForwardERC20",n=[e.fromToken.contract,i._params.amountIn,s,p,y,e.fastMctpInputContract,r,i._params.contractAddress,i.data];return{data:u.interface.encodeFunctionData(t,n),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:a,_forwarder:{method:t,params:n}}}}{let i=eB(e,t,n,a,r),m=A(e.minMiddleAmount,6);if(e.fromToken.contract===o.N){let t="swapAndForwardEth",n=[i._params.amountIn,p,y,e.fastMctpInputContract,m,i._params.contractAddress,i.data];return{data:u.interface.encodeFunctionData(t,n),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(i._params.amountIn),chainId:a,_forwarder:{method:t,params:n}}}{let t="swapAndForwardERC20",n=[e.fromToken.contract,i._params.amountIn,s,p,y,e.fastMctpInputContract,m,i._params.contractAddress,i.data];return{data:u.interface.encodeFunctionData(t,n),to:f.MAYAN_FORWARDER_CONTRACT,value:(0,l.m9)(0),chainId:a,_forwarder:{method:t,params:n}}}}}}(e,n,I,r,m,p);if("WH"!=e.type)throw Error("Unsupported quote type");if(!Number(e.deadline64))throw Error("WH mode requires a timeout");let{relayerFees:C,recipient:P,tokenOut:R,tokenOutWChainId:_,criteria:O,tokenIn:D,amountIn:B,contractAddress:v,bridgeFee:K}=function(e,t,n,a,i,r){let p;let y=new s.PublicKey(f.MAYAN_PROGRAM_ID),[l]=s.PublicKey.findProgramAddressSync([u.Buffer.from("MAIN")],y),m=w(new s.PublicKey(e.fromToken.mint),l,!0),d=BigInt(e.effectiveAmountIn64),c=h(m.toString(),1),b=h(f.AUCTION_PROGRAM_ID,1);p=n?h(n,1):h(s.SystemProgram.programId.toString(),1);let T=k[Number(i)],g=M[e.fromChain],I=M[e.toChain];if(g!==T)throw Error(`Signer chain id(${Number(i)}) and quote from chain are not same! ${g} !== ${T}`);let C=e.whMayanContract,P={mayanAddr:c,mayanChainId:1,destAddr:h(t,I),destChainId:I,auctionAddr:b,referrer:p,refundAddr:h(a,T)},R=e.toToken.contract===o.N,_={transferDeadline:BigInt(e.deadline64),swapDeadline:BigInt(e.deadline64),amountOutMin:A(e.minAmountOut,Math.min(8,e.toToken.decimals)),gasDrop:A(e.gasDrop,Math.min(8,S(e.toChain))),unwrap:R,customPayload:r?`0x${u.Buffer.from(r).toString("hex")}`:"0x"},E={swapFee:A(e.swapRelayerFee,Math.min(8,e.fromToken.decimals)),redeemFee:A(e.redeemRelayerFee,Math.min(8,e.toToken.decimals)),refundFee:A(e.refundRelayerFee,Math.min(8,e.fromToken.decimals))},O=h(e.toToken.realOriginContractAddress,e.toToken.realOriginChainId),F=A(e.bridgeFee,18);return{amountIn:d,tokenIn:e.fromToken.contract,tokenOut:O,tokenOutWChainId:e.toToken.realOriginChainId,criteria:_,recipient:P,relayerFees:E,contractAddress:C,bridgeFee:F}}(e,n,I,i,r,p),N=new y.CH(f.MAYAN_FORWARDER_CONTRACT,U),W=new y.CH(v,x);if(D===o.N)d="forwardEth",c=[v,W.interface.encodeFunctionData("wrapAndSwapETH",[C,P,R,_,O])],b=(0,l.m9)(B);else{let e=W.interface.encodeFunctionData("swap",[C,P,R,_,O,D,B]);d="forwardERC20",c=[D,B,m||E,v,e],b=(0,l.m9)(K)}let G=N.interface.encodeFunctionData(d,c);return{to:f.MAYAN_FORWARDER_CONTRACT,data:G,value:b,chainId:r,_forwarder:{method:d,params:c}}}}}]);